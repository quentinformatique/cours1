-- EXERCICE 1
-- 1.
SELECT *
FROM film
WHERE annee < 1996;

-- 2.
SELECT *
FROM film
WHERE genre='Drame'
AND anne < 2000;

-- 3.
SELECT *
FROM film
WHERE genre='Drame'
OR anne < 1990;

-- 4.
SELECT *
FROM film
WHERE NOT( anne > 2000
OR genre='Policier');

-- 5.
SELECT *
FROM film
WHERE genre='Drame'
AND NOT annee>2000;

-- 6.
SELECT DISTINCT titre, genre, annee 
FROM film;

--7.
SELECT DISTINCT genre
FROM film;

-- 8.
SELECT DISTINCT genre
FROM film
WHERE annee<1988;


-- 9.
SELECT DISTINCT nom, prenom
FROM personne
WHERE prenom = 'Jhon'
UNION
SELECT DISTINCT nom, prenom
FROM personne
WHERE prenom='Paul';

-- 10.
SELECT DISTINCT prenom
FROM personne
INTERSECT
SELECT DISTINCT role
FROM jouer;

-- 11.
SELECT DISTINCT nom
FROM personne
WHERE nom LIKE 'T%'
MINUS
SELECT DISTINCT nom
FROM personne
WHERE prenom='Jhon';

-- 12.
SELECT DISTINCT film.titre, film.genre, cinema.nom
FROM film, cinema
WHERE film.annee <= 1998;

-- 13.
SELECT DISTINCT titre, nom, prenom
FROM FILM
INNER JOIN personne
ON film.idRealisateur = personne.idPersonne;
 
-- 14.
DROP TABLE R1;
DROP TABLE R2;

CREATE TABLE R1 (
    nom VARCHAR2(50),
    prenom VARCHAR2(50),
    titre VARCHAR(50)
);

CREATE TABLE R2 (
    titre VARCHAR2(50)
);

INSERT INTO R1
SELECT nom, prenom, titre
FROM film
INNER JOIN jouer
ON film.idFilm = jouer.idFilm
INNER JOIN personne
ON jouer.idActeur = personne.idPersonne;

INSERT INTO R2
SELECT DISTINCT titre
FROM film
INNER JOIN personne
ON film.idRealisateur = personne.idPersonne
WHERE prenom='Lars';

SELECT DISTINCT nom, prenom FROM R1 X
WHERE NOT EXISTS (
(SELECT titre FROM R2)
MINUS
(SELECT titre FROM R1 WHERE X.nom = R1.nom AND X.prenom = R1.prenom)
);


--EXERCICE 2
-- 1.
SELECT DISTINCT titre 
FROM film
WHERE genre='Drame';

-- 2.
SELECT DISTINCT titre
FROM film
INNER JOIN projection
ON projection.idfilm = film.idfilm
INNER JOIN cinema
ON projection.idcinema = cinema.idcinema
WHERE cinema.nom='Le fontenelle';

-- 3.
SELECT DISTINCT nom, prenom
FROM personne
INNER JOIN film
ON film.idrealisateur = personne.idpersonne;

-- 4.
SELECT DISTINCT nom, prenom
FROM personne
INNER JOIN jouer
ON jouer.idacteur = personne.idpersonne;

-- 5.
SELECT DISTINCT nom, prenom
FROM personne
INNER JOIN film
ON film.idrealisateur = personne.idpersonne
INNER JOIN jouer
ON jouer.idacteur = personne.idpersonne;

-- 6.
/*
attention au froamt de date :
ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD';

ou 

SELECT TO_CHAR(jour, 'YYYY')
FROM projection;

SELECT TO_CHAR(jour, 'DD/MM/Y')
FROM projection;

SELECT TO_CHAR(jour, 'month')
FROM projection;

SELECT TO_CHAR(jour, 'DD/MM/YYYY/HH/MI/SS')
FROM projection;

SELECT TO_DATE('01/12/2002', 'MM/DD/YYYY')
FROM dual

SELECT TO_DATE(annee, 'YYYY')
FROM film
...
*/
 
SELECT DISTINCT titre
FROM film
INNER JOIN projection
ON projection.idfilm = film.idfilm
WHERE TO_CHAR(projection.jour, 'YYYY')='2002';

-- 7.
SELECT DISTINCT titre
FROM film
INNER JOIN personne
ON film.idrealisateur = personne.idpersonne
WHERE personne.nom = 'von Trier' and personne.prenom = 'Lars';

-- 8.
(SELECT DISTINCT nom, prenom
FROM personne
INNER JOIN film
ON personne.idpersonne = film.idrealisateur
WHERE genre = 'Drame')
INTERSECT
(SELECT DISTINCT nom, prenom
FROM personne
INNER JOIN film
ON personne.idpersonne = film.idrealisateur
WHERE genre = 'Epouvante');

-- OU --

SELECT DISTICNT nom, prenom
FROM personne
INNER JOIN film F1
ON film.idrealisateur = personne.idpersonne
INNER JOIN film F2
ON personne.idpersonne = film.idrealisateur
WHERE F1.genre = 'Drame' AND F2.genre = 'Epouvante';

-- 9.
SELECT DISTINCT titre
FROM film
INNER JOIN jouer
ON jouer.idfilm = film.idfilm
INNER JOIN personne
ON jouer.idacteur = personne.idpersonne
INNER JOIN projection
ON film.idfilm = projection.idfilm
INNER JOIN cinema
ON projection.idcinema = cinema.idcinema
WHERE cinema.nom = 'Le Fontenelle' 
AND personne.nom = 'Kidman'
AND personne.prenom = 'Nicole';


-- 10.
(SELECT DISTINCT nom, prenom
FROM personne 
INNER JOIN jouer
ON jouer.idacteur = personne.idpersonne
INNER JOIN film
ON film.idfilm = jouer.idfilm)
MINUS
(SELECT DISTINCT nom, prenom
FROM personne 
INNER JOIN jouer
ON jouer.idacteur = personne.idpersonne
INNER JOIN film
ON film.idfilm = jouer.idfilm
WHERE genre = 'Drame');

-- 11.
SELECT DISTINCT personne.nom, personne.prenom
FROM personne
INNER JOIN jouer
ON jouer.idacteur = personne.idpersonne
INNER JOIN film
ON jouer.idfilm = film.idfilm
INNER JOIN projection
ON film.idfilm = projection.idfilm
INNER JOIN cinema
ON projection.idcinema = cinema.idcinema
WHERE cinema.nom = 'Le Fontenelle'
AND TO_CHAR(projection.jour, 'YYYY') >= '2000';

-- OU -- (pour eviter la comparaison de chaines)

SELECT DISTINCT personne.nom, personne.prenom
FROM personne
INNER JOIN jouer
ON jouer.idacteur = personne.idpersonne
INNER JOIN film
ON jouer.idfilm = film.idfilm
INNER JOIN projection
ON film.idfilm = projection.idfilm
INNER JOIN cinema
ON projection.idcinema = cinema.idcinema
WHERE cinema.nom = 'Le Fontenelle'
AND TO_NUMBER(TO_CHAR(projection.jour, 'YYYY')) >= 2000;

-- 12.
SELECT DISTINCT p1.nom, p1.prenom
FROM personne p1
WHERE p1.prenom IN (
    SELECT prenom
    FROM personne
    INNER JOIN jouer
    ON personne.idpersonne = jouer.idacteur
)
AND P1.prenom IN (
    SELECT prenom
    FROM personne
    INNER JOIN film
    ON personne.idpersonne = film.idrealisateur
)
AND p1.prenom NOT IN (
    SELECT prenom
    FROM personne
    INNER JOIN film
    ON personne.idpersonne = film.idrealisateur
    INNER JOIN jouer
    ON personne.idpersonne = jouer.idacteur
);

-- OU --

SELECT DISTINCT nom, prenom
FROM personne pers0
InNER JOIN personne pers1
ON pers1.idpersonne = pers0.idpersonne
INNER JOIN JOUER
ON pers1.idpersonne = jouer.idacteur
INNER JOIN personne pers2
ON (pers1.prenom = pers2.prenom
AND pers1.idpersonne != pers2.idPersonne)
INNER JOIN film 
ON film.idrealisateur = pers2.idpersonne;

-- 13.
DROP TABLE R1;
DROP TABLE R2;

CREATE TABLE R1 AS (
    SELECT cinema.nom, film.idfilm
    FROM cinema
    INNER JOIN projection
    ON projection.idcinema = cinema.idcinema
    INNER JOIN film
    ON preojectionidfilm = film.idfilm
);
CREATE TABLE R2 AS (
    SELECT DISTINCT idfilm
    FROM film
);

SELECT DISTINCT nom FROM R1 X
WHERE NOT EXISTS
(SELECT idfilm FROM R2)
MINUS
(SELECT idfilm FROM R1 WHERE X.nom = R1.nom);

-- 14.
DROP TABLE R1;
DROP TABLE R2;

CREATE TABLE R1 AS (
    SELECT personne.nom, personne.prenom, cinema.idcinema
    FROM personne
    INNER JOIN jouer
    ON jouer.idacteur = personne.idpersonne
    INNER JOIN projection
    ON projection.idfilm = jouer.idfilm
    INNER JOIN cinema
    ON cinema.idcinema = projection.idfilm
);

CREATE TABLE R2 AS (
    SELECT idcinema
    FROM cinema
);

SELECT DISTINCT nom, prenom FROM R1 X
WHERE NOT EXISTS(
(SELECT idcinema FROM R2)
MINUS
(SELECT idcinema FROM R1 WHERE (X.prenom = R1.prenom AND X.nom = R1.nom))
);




































